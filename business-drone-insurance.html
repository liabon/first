<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KBì†í•´ë³´í—˜ ì—…ë¬´ìš© ë“œë¡ ë³´í—˜ ê°€ì… - ë°°ìƒì˜¨ ëŒ€ë¦¬ì </title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --kb-yellow: #FFCD00;
            --kb-gold: #FFB800;
            --kb-dark: #1a1a1a;
            --kb-gray: #666;
            --kb-light-gray: #f8f9fa;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            color: var(--kb-dark);
            line-height: 1.6;
            background: var(--kb-light-gray);
        }

        header {
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .kb-logo {
            height: 50px;
        }

        .divider {
            height: 40px;
            width: 1px;
            background: #ddd;
        }

        .agency-name {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .home-btn {
            padding: 0.7rem 1.3rem;
            background: var(--kb-gold);
            color: var(--kb-dark);
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            font-size: 0.95rem;
        }

        .home-btn:hover {
            background: var(--kb-yellow);
            transform: translateY(-2px);
        }

        .progress-section {
            background: #fff;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .progress-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
        }

        .progress-step {
            text-align: center;
            flex: 1;
        }

        .step-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ddd;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            margin: 0 auto 0.5rem;
        }

        .progress-step.active .step-circle {
            background: var(--kb-gold);
            color: var(--kb-dark);
        }

        .progress-step.completed .step-circle {
            background: var(--kb-gold);
            color: #fff;
        }

        .step-label {
            font-size: 0.9rem;
            color: #999;
        }

        .progress-step.active .step-label {
            color: var(--kb-dark);
            font-weight: 600;
        }

        .main-content {
            max-width: 1000px;
            margin: 3rem auto;
            padding: 0 2rem;
        }

        .section-card {
            background: #fff;
            border-radius: 20px;
            padding: 3rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid var(--kb-gold);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: 700;
            font-size: 1.05rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--kb-gold);
            box-shadow: 0 0 0 3px rgba(255, 184, 0, 0.1);
        }

        .form-group small {
            display: block;
            margin-top: 0.5rem;
            color: var(--kb-gray);
            font-size: 0.9rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .drone-info-section {
            border: 2px solid var(--kb-gold);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            background: #fffbf0;
        }

        .drone-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .drone-number {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--kb-gold);
        }

        .remove-drone-btn {
            padding: 0.5rem 1rem;
            background: #ff6b6b;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .remove-drone-btn:hover {
            background: #ff5252;
        }

        .add-drone-btn {
            width: 100%;
            padding: 1rem;
            background: #fff;
            border: 2px dashed var(--kb-gold);
            border-radius: 12px;
            color: var(--kb-gold);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 2rem;
        }

        .add-drone-btn:hover {
            background: #fffbf0;
        }

        /* ê³ ê° íƒ€ì… íƒ­ */
        .customer-type-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #e8e8e8;
            padding-bottom: 0;
        }

        .type-tab {
            flex: 1;
            padding: 0.9rem 1rem;
            border: 2px solid #e8e8e8;
            border-bottom: none;
            border-radius: 10px 10px 0 0;
            background: #f8f9fa;
            color: #999;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .type-tab.active {
            background: #FFB800;
            color: #1a1a1a;
            border-color: #FFB800;
            position: relative;
            bottom: -2px;
        }

        .type-tab:hover:not(.active) {
            background: #fff9e6;
            color: #1a1a1a;
            border-color: #FFB800;
        }

        .notice-box {
            background: #fff9e6;
            border-left: 4px solid var(--kb-gold);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 8px;
        }

        .notice-box strong {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--kb-dark);
        }

        .notice-box p {
            margin: 0.3rem 0;
            font-size: 0.95rem;
            color: var(--kb-gray);
        }

        .drone-type-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .drone-type-card {
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            padding: 2rem 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .drone-type-card:hover {
            border-color: var(--kb-gold);
            transform: translateY(-5px);
        }

        .drone-type-card.selected {
            border-color: var(--kb-gold);
            background: #fff9e6;
        }

        .drone-type-card input[type="radio"] {
            display: none;
        }

        .drone-type-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .drone-type-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .plan-category {
            margin-bottom: 3rem;
        }

        .plan-category h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--kb-gold);
        }

        .plan-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .plan-card {
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .plan-card:hover {
            border-color: var(--kb-gold);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .plan-card.selected {
            border-color: var(--kb-gold);
            background: #fff9e6;
        }

        .plan-card input[type="radio"] {
            display: none;
        }

        .plan-name {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--kb-gold);
        }

        .plan-coverage {
            margin-bottom: 1rem;
        }

        .plan-coverage-item {
            padding: 0.5rem 0;
            font-size: 0.95rem;
            color: var(--kb-gray);
        }

        .plan-price {
            font-size: 2rem;
            font-weight: 900;
            color: var(--kb-dark);
            margin-top: 1.5rem;
            text-align: right;
        }

        .plan-price span {
            font-size: 1rem;
            font-weight: 400;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 3rem;
        }

        .btn {
            padding: 1.2rem 3rem;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: var(--kb-dark);
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn-primary {
            background: var(--kb-gold);
            color: var(--kb-dark);
            box-shadow: 0 8px 25px rgba(255, 184, 0, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 184, 0, 0.4);
        }

        .btn-primary:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        footer {
            background: var(--kb-dark);
            color: #fff;
            padding: 3rem 2rem;
            margin-top: 5rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-content p {
            margin-bottom: 0.5rem;
            opacity: 0.8;
            font-size: 0.95rem;
        }

        @media (max-width: 768px) {
            .section-card {
                padding: 2rem 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .drone-type-grid,
            .plan-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
    <style>
        /* í—¤ë” ëª¨ë°”ì¼ ìµœì í™” */
        .home-btn { white-space: nowrap; }
        @media (max-width: 768px) {
            .header-content { padding: 0.8rem 1rem; }
            .kb-logo { height: 32px; }
            .divider { height: 24px; }
            .agency-name { font-size: 1rem; }
            .home-btn { padding: 0.5rem 0.8rem; font-size: 0.8rem; }
        }
        @media (max-width: 400px) {
            .agency-name { font-size: 0.85rem; }
            .home-btn { padding: 0.4rem 0.6rem; font-size: 0.75rem; }
            .kb-logo { height: 26px; }
        }

        /* ê³ ê° íƒ€ì… íƒ­ */
        .customer-type-tabs { display:flex; gap:0.5rem; margin-bottom:1.5rem; border-bottom:2px solid #e8e8e8; }
        .type-tab {
            flex:1; padding:0.9rem 1rem; border:2px solid #e8e8e8; border-bottom:none;
            border-radius:10px 10px 0 0; background:#f8f9fa; color:#999;
            font-size:0.95rem; font-weight:600; cursor:pointer; transition:all 0.2s;
            font-family:'Noto Sans KR',sans-serif;
        }
        .type-tab.active { background:#FFB800; color:#1a1a1a; border-color:#FFB800; position:relative; bottom:-2px; }
        .type-tab:hover:not(.active) { background:#fff9e6; color:#1a1a1a; border-color:#FFB800; }

        /* ê°€ì…ë¬¼ê±´ ì¤‘ëŸ‰ ì¹´ë“œ */
        .weight-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:1rem; margin-bottom:1.5rem; }
        .weight-card {
            border:2px solid #e8e8e8; border-radius:12px; padding:1.2rem 1rem;
            cursor:pointer; text-align:center; transition:all 0.2s; background:#fff;
        }
        .weight-card:hover { border-color:#FFB800; background:#fff9e6; }
        .weight-card.selected { border-color:#FFB800; background:#FFB800; }
        .weight-card input[type="radio"] { display:none; }
        .weight-icon { font-size:2rem; margin-bottom:0.5rem; }
        .weight-label { font-weight:700; font-size:0.9rem; color:#1a1a1a; line-height:1.4; }
        .weight-sub { font-size:0.75rem; color:#666; margin-top:0.3rem; }
        .weight-card.selected .weight-sub { color:#555; }

        /* ë“œë¡  ìœ í˜• ì²´í¬ */
        .drone-flag-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:1rem; }
        .flag-card {
            border:2px solid #e8e8e8; border-radius:12px; padding:1rem;
            cursor:pointer; text-align:center; transition:all 0.2s; background:#fff;
        }
        .flag-card:hover { border-color:#FFB800; background:#fff9e6; }
        .flag-card.selected { border-color:#FFB800; background:#FFB800; }
        .flag-card input[type="radio"] { display:none; }
        .flag-icon { font-size:1.5rem; margin-bottom:0.4rem; }
        .flag-label { font-weight:700; font-size:0.85rem; color:#1a1a1a; line-height:1.3; }

        /* ê²¬ì  í•„ìš” ì•ˆë‚´ */
        .quote-needed-box {
            display:none; background:#fff3cd; border:2px solid #FFB800;
            border-radius:12px; padding:1.5rem; margin-top:1.5rem; text-align:center;
        }
        .quote-needed-box.show { display:block; }
        .quote-needed-box p { color:#856404; margin-bottom:1rem; font-weight:600; line-height:1.6; }
        .btn-quote-request {
            background:#FFB800; color:#1a1a1a; border:none; border-radius:8px;
            padding:0.8rem 2rem; font-size:1rem; font-weight:700; cursor:pointer;
            font-family:'Noto Sans KR',sans-serif; transition:all 0.2s;
        }
        .btn-quote-request:hover { background:#FFCD00; transform:translateY(-2px); }

        /* ê²¬ì  ì˜ë¢° ëª¨ë‹¬ */
        .modal-overlay {
            display:none; position:fixed; top:0; left:0; width:100%; height:100%;
            background:rgba(0,0,0,0.7); z-index:9999;
            overflow-y:auto; padding:2rem 1rem;
        }
        .modal-overlay.show { display:block; }
        .modal-box {
            background:#fff; width:100%; max-width:560px; border-radius:16px;
            box-shadow:0 10px 40px rgba(0,0,0,0.3); margin:0 auto;
        }
        .modal-head {
            background:linear-gradient(135deg,#FFB800,#FFCD00); padding:1.4rem 1.5rem;
            border-radius:16px 16px 0 0; display:flex; justify-content:space-between; align-items:center;
        }
        .modal-head h2 { font-size:1.3rem; font-weight:700; color:#1a1a1a; margin:0; }
        .modal-close-btn { background:none; border:none; font-size:1.8rem; cursor:pointer; color:#1a1a1a; line-height:1; padding:0; }
        .modal-body { padding:1.5rem; }
        .modal-alert { background:#fff9e6; border-left:4px solid #FFB800; padding:1rem 1.2rem; border-radius:8px; margin-bottom:1rem; }
        .modal-alert p { margin:0.3rem 0; color:#555; font-size:0.88rem; line-height:1.6; }
        .modal-contact { background:#f8f9fa; padding:0.7rem 1rem; border-radius:8px; margin-bottom:1rem; font-size:0.88rem; color:#444; }
        .modal-section-title { font-weight:700; font-size:0.95rem; color:#1a1a1a; border-bottom:2px solid #FFB800; padding-bottom:0.4rem; margin:1rem 0 0.7rem; }
        .modal-form-group { margin-bottom:0.8rem; }
        .modal-form-group label { display:block; font-weight:600; font-size:0.88rem; margin-bottom:0.3rem; }
        .modal-form-group input, .modal-form-group select, .modal-form-group textarea {
            width:100%; padding:0.65rem 0.8rem; border:1.5px solid #ddd;
            border-radius:8px; font-size:0.88rem; font-family:'Noto Sans KR',sans-serif;
        }
        .modal-form-group input:focus, .modal-form-group select:focus { border-color:#FFB800; outline:none; }
        .modal-form-row { display:grid; grid-template-columns:1fr 1fr; gap:0.8rem; }
        .drone-count-row { display:flex; align-items:center; gap:0.5rem; }
        .drone-count-row input { flex:1; }
        .privacy-scroll {
            background:#f8f9fa; border:1px solid #ddd; border-radius:8px;
            padding:0.8rem 1rem; max-height:130px; overflow-y:auto;
            font-size:0.8rem; color:#666; line-height:1.7; margin-bottom:0.8rem;
        }
        .privacy-scroll p { margin:0.15rem 0; }
        .agree-row { display:flex; align-items:center; gap:0.5rem; margin-bottom:1rem; }
        .agree-row input[type="checkbox"] { width:18px; height:18px; cursor:pointer; }
        .agree-row label { font-size:0.87rem; font-weight:600; cursor:pointer; }
        .btn-submit-modal {
            width:100%; padding:1rem; background:#FFB800; color:#1a1a1a;
            border:none; border-radius:8px; font-size:1rem; font-weight:700;
            cursor:pointer; font-family:'Noto Sans KR',sans-serif; transition:all 0.2s;
        }
        .btn-submit-modal:hover { background:#FFCD00; }

        @media (max-width:480px) {
            .modal-form-row { grid-template-columns:1fr; }
            .weight-grid { grid-template-columns:1fr; }
            .drone-flag-grid { grid-template-columns:1fr; }
        }

        /* â”€â”€ í”Œëœ ì„ íƒ ì„¹ì…˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .plan-section { display:none; }
        .plan-section.show { display:block; }

        .deductible-toggle {
            display:flex; align-items:center; gap:0.8rem;
            margin-bottom:1.8rem; justify-content:flex-end;
        }
        .deductible-label { font-weight:700; font-size:0.95rem; color:#666; }
        .toggle-btns { display:flex; border:2px solid #e0e0e0; border-radius:10px; overflow:hidden; }
        .toggle-btn {
            padding:0.55rem 1.2rem; background:#fff; border:none; cursor:pointer;
            font-weight:700; font-size:0.9rem; color:#999; font-family:'Noto Sans KR',sans-serif;
            transition:all 0.2s;
        }
        .toggle-btn.active { background:#1a1a1a; color:#FFB800; }

        /* ë“œë¡  ì•„ì½”ë””ì–¸ (2ëŒ€ ì´ìƒ) */
        .drone-plan-accordion { margin-bottom:1.2rem; }
        .drone-accordion-header {
            display:flex; justify-content:space-between; align-items:center;
            background:#f8f9fa; border:2px solid #e0e0e0; border-radius:12px;
            padding:1rem 1.4rem; cursor:pointer; transition:all 0.2s; user-select:none;
        }
        .drone-accordion-header.open { border-color:#FFB800; background:#fff9e6; border-radius:12px 12px 0 0; }
        .drone-accordion-title { font-weight:700; font-size:1rem; color:#1a1a1a; }
        .drone-accordion-badge {
            font-size:0.82rem; font-weight:600; color:#FFB800;
            background:#fff3cd; padding:0.2rem 0.6rem; border-radius:20px;
        }
        .drone-accordion-arrow { font-size:1rem; color:#999; transition:transform 0.2s; }
        .drone-accordion-header.open .drone-accordion-arrow { transform:rotate(180deg); }
        .drone-accordion-body {
            display:none; border:2px solid #FFB800; border-top:none;
            border-radius:0 0 12px 12px; padding:1.5rem;
            background:#fff;
        }
        .drone-accordion-body.open { display:block; }

        /* í”Œëœ í…Œì´ë¸” */
        .plan-table-wrap { overflow-x:auto; }
        .plan-table {
            width:100%; border-collapse:collapse; min-width:380px;
        }
        .plan-table th, .plan-table td {
            border:1px solid #e8e8e8; padding:0.7rem 0.8rem;
            text-align:center; font-size:0.92rem;
        }
        .plan-table thead th { background:#f8f9fa; font-weight:700; color:#666; font-size:0.85rem; }
        .plan-table .row-label { text-align:left; font-weight:600; color:#1a1a1a; background:#fafafa; }
        .plan-table .price-row td { font-weight:900; font-size:1.1rem; }
        .plan-table .plan-col {
            cursor:pointer; transition:background 0.15s;
            position:relative;
        }
        .plan-table .plan-col:hover { background:#fff9e6; }
        .plan-table .plan-col.selected { background:#e8f4ff; }
        .plan-col-header { padding:0.6rem 0.5rem !important; }
        .plan-radio-wrap { display:flex; flex-direction:column; align-items:center; gap:0.3rem; }
        .plan-radio-wrap input[type="radio"] { width:18px; height:18px; accent-color:#3182f6; cursor:pointer; }
        .plan-name-text { font-weight:800; font-size:1rem; color:#1a1a1a; }
        .plan-price-text { font-weight:900; color:#3182f6; font-size:1.05rem; }
        .coverage-label { font-size:0.82rem; color:#888; font-weight:500; }

        /* ì´ ë³´í—˜ë£Œ ìš”ì•½ */
        .plan-total-box {
            background:#1a1a1a; border-radius:12px; padding:1.2rem 1.5rem;
            display:flex; justify-content:space-between; align-items:center;
            margin-top:1.5rem;
        }
        .plan-total-label { color:#aaa; font-size:0.95rem; font-weight:600; }
        .plan-total-amount { color:#FFB800; font-size:1.6rem; font-weight:900; }

        @media (max-width:480px) {
            .plan-table th, .plan-table td { padding:0.5rem 0.4rem; font-size:0.8rem; }
            .plan-name-text { font-size:0.85rem; }
            .plan-price-text { font-size:0.9rem; }
            .plan-total-amount { font-size:1.2rem; }
            .deductible-toggle { flex-wrap:wrap; justify-content:flex-start; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-section">
                <img src="kb-logo.png" alt="KBì†í•´ë³´í—˜" class="kb-logo">
                <div class="divider"></div>
                <div class="agency-name">ë°°ìƒì˜¨ ëŒ€ë¦¬ì </div>
            </div>
            <a href="/" class="home-btn">ğŸ  í™ˆìœ¼ë¡œ</a>
        </div>
    </header>

    <div class="progress-section">
        <div class="progress-container">
            <div class="progress-steps">
                <div class="progress-step completed">
                    <div class="step-circle">1</div>
                    <div class="step-label">ì˜ë¬´í™•ì¸</div>
                </div>
                <div class="progress-step active">
                    <div class="step-circle">2</div>
                    <div class="step-label">ì •ë³´ì…ë ¥</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle">3</div>
                    <div class="step-label">ì•½ê´€ë™ì˜</div>
                </div>
                <div class="progress-step">
                    <div class="step-circle">4</div>
                    <div class="step-label">ì™„ë£Œ</div>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <form id="droneForm">

            <!-- ê³ ê°ì •ë³´ -->
            <div class="section-card">
                <h2 class="section-title" id="customerSectionTitle">ê³ ê°ì •ë³´ ì…ë ¥</h2>
                <div class="customer-type-tabs">
                    <button type="button" class="type-tab active" id="tabPersonal" onclick="switchType('personal')">ğŸ‘¤ ê°œì¸ / ê°œì¸ì‚¬ì—…ì</button>
                    <button type="button" class="type-tab" id="tabCorporate" onclick="switchType('corporate')">ğŸ¢ ë²•ì¸</button>
                </div>

                <!-- ê°œì¸ -->
                <div id="personalFields">
                    <div class="form-group">
                        <label>ì´ë¦„ *</label>
                        <input type="text" name="name" id="personalName" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ìƒë…„ì›”ì¼ *</label>
                            <input type="text" name="birth_date" id="birthDate" placeholder="YYMMDD (ì˜ˆ: 901225)" maxlength="6" inputmode="numeric" pattern="[0-9]{6}" required>
                            <small>ìˆ«ì 6ìë¦¬ ì…ë ¥ (ì˜ˆ: 901225)</small>
                        </div>
                        <div class="form-group">
                            <label>ì„±ë³„ *</label>
                            <select name="gender" id="personalGender" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                                <option value="male">ë‚¨ì„±</option>
                                <option value="female">ì—¬ì„±</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì—°ë½ì²˜ *</label>
                            <input type="tel" name="phone" id="personalPhone" placeholder="010-0000-0000" required>
                        </div>
                        <div class="form-group">
                            <label>ì´ë©”ì¼ *</label>
                            <input type="email" name="email" id="personalEmail" placeholder="example@email.com" required>
                        </div>
                    </div>
                </div>

                <!-- ë²•ì¸ -->
                <div id="corporateFields" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ *</label>
                            <input type="text" name="corp_number" id="corpNumber" placeholder="000-00-00000">
                            <small>í•˜ì´í”ˆ(-)ì„ í¬í•¨í•˜ì—¬ ì…ë ¥í•´ì£¼ì„¸ìš”</small>
                        </div>
                        <div class="form-group">
                            <label>íšŒì‚¬ëª… *</label>
                            <input type="text" name="corp_name" id="corpName" placeholder="íšŒì‚¬ëª…">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ë‹´ë‹¹ì ì—°ë½ì²˜ *</label>
                            <input type="tel" name="corp_phone" id="corpPhone" placeholder="010-0000-0000">
                        </div>
                        <div class="form-group">
                            <label>ë‹´ë‹¹ì ì´ë©”ì¼ *</label>
                            <input type="email" name="corp_email" id="corpEmail" placeholder="example@email.com">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë³´í—˜ê¸°ê°„ -->
            <div class="section-card">
                <h2 class="section-title">ë³´í—˜ê¸°ê°„</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>ë³´í—˜ì‹œì‘ì¼ì‹œ *</label>
                        <input type="datetime-local" name="insurance_start" id="insuranceStart" required>
                        <small>ë³´í—˜ì‹œì‘ì¼ì€ 30ë¶„ ë‹¨ìœ„ë¡œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤</small>
                    </div>
                    <div class="form-group">
                        <label>ë³´í—˜ì¢…ë£Œì¼ì‹œ *</label>
                        <input type="datetime-local" name="insurance_end" id="insuranceEnd" required>
                        <small>ìë™ìœ¼ë¡œ 1ë…„ í›„ë¡œ ì„¤ì •ë©ë‹ˆë‹¤ (ìˆ˜ì • ê°€ëŠ¥)</small>
                    </div>
                </div>
                <div class="form-group">
                    <label>ê°€ì… ê¸°ê°„</label>
                    <input type="text" id="insuranceDuration" readonly style="background:#f8f9fa;font-weight:700;color:#FFB800;">
                </div>
                <div class="form-group">
                    <label>ë³´í—˜ê°€ì… ì†Œì¬ì§€</label>
                    <input type="text" value="ì „êµ­ì¼ì› (ë³´í—˜ë‹´ë³´ì§€ì—­: ëŒ€í•œë¯¼êµ­)" readonly style="background:#f8f9fa;">
                </div>
                <div class="notice-box">
                    <strong>ğŸ“Œ ë³´í—˜ê¸°ê°„ ì•ˆë‚´</strong>
                    <p>â€¢ ë“œë¡ ë³´í—˜ê¸°ê°„ì€ 1ë…„ì„ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>

            <!-- ë“œë¡  ëŒ€ìˆ˜ -->
            <div class="section-card">
                <h2 class="section-title">ë“œë¡  ëŒ€ìˆ˜</h2>
                <div class="form-group">
                    <label>ë³´í—˜ ê°€ì…í•  ë“œë¡  ëŒ€ìˆ˜ *</label>
                    <input type="number" name="drone_count" id="droneCount" min="1" max="10" value="1" required oninput="updateDroneFields()">
                    <small>ìµœëŒ€ 10ëŒ€ê¹Œì§€ ê°€ì… ê°€ëŠ¥í•©ë‹ˆë‹¤</small>
                </div>
            </div>

            <!-- ë“œë¡  ì •ë³´ -->
            <div class="section-card">
                <h2 class="section-title">ë“œë¡  ì •ë³´</h2>
                <div class="notice-box">
                    <strong>âš ï¸ í•„ìˆ˜ í™•ì¸ì‚¬í•­</strong>
                    <p>â€¢ ë“œë¡ ìì²´ì¤‘ëŸ‰ì€ ë°°í„°ë¦¬ ì œì™¸ ë¬´ê²Œì…ë‹ˆë‹¤</p>
                    <p>â€¢ ë“œë¡ ìµœëŒ€ì´ë¥™ì¤‘ëŸ‰ì€ ì´ë¥™ ì‹œ ìµœëŒ€ì¤‘ëŸ‰ì…ë‹ˆë‹¤</p>
                    <p>â€¢ ì‹œë¦¬ì–¼ë²ˆí˜¸, ì‹ ê³ ë²ˆí˜¸ëŠ” ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
                </div>
                <div id="dronesContainer"></div>
            </div>

            <!-- ê°€ì…ë¬¼ê±´ ì„ íƒ -->
            <div class="section-card">
                <h2 class="section-title">ê°€ì…ë¬¼ê±´ ì„ íƒ</h2>

                <div class="form-group">
                    <label>ìì²´ì¤‘ëŸ‰ ì„ íƒ *</label>
                    <div class="weight-grid">
                        <label class="weight-card" onclick="selectWeight(this,'under_25kg')">
                            <input type="radio" name="drone_weight" value="under_25kg">
                            <div class="weight-icon">ğŸš</div>
                            <div class="weight-label">25kg ë¯¸ë§Œ</div>
                            <div class="weight-sub">ì˜ë¬´/ì—…ë¬´/ì˜ë¦¬</div>
                        </label>
                        <label class="weight-card" onclick="selectWeight(this,'25_100kg')">
                            <input type="radio" name="drone_weight" value="25_100kg">
                            <div class="weight-icon">ğŸš</div>
                            <div class="weight-label">25kg ì´ìƒ<br>100kg ë¯¸ë§Œ</div>
                            <div class="weight-sub">ì˜ë¬´/ì—…ë¬´/ì˜ë¦¬</div>
                        </label>
                        <label class="weight-card" onclick="selectWeight(this,'over_100kg')">
                            <input type="radio" name="drone_weight" value="over_100kg">
                            <div class="weight-icon">ğŸš</div>
                            <div class="weight-label">100kg ì´ìƒ</div>
                            <div class="weight-sub">ì˜ë¬´/ì—…ë¬´/ì˜ë¦¬</div>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>ë“œë¡  ìœ í˜• *</label>
                    <div class="drone-flag-grid">
                        <label class="flag-card" onclick="selectFlag(this,'swarm')">
                            <input type="radio" name="drone_flag" value="swarm">
                            <div class="flag-icon">ğŸ</div>
                            <div class="flag-label">êµ°ì§‘ë“œë¡ </div>
                        </label>
                        <label class="flag-card" onclick="selectFlag(this,'rental')">
                            <input type="radio" name="drone_flag" value="rental">
                            <div class="flag-icon">ğŸ­</div>
                            <div class="flag-label">ì„ëŒ€ì‚¬ì—…ì ë“œë¡ </div>
                        </label>
                        <label class="flag-card" onclick="selectFlag(this,'none')">
                            <input type="radio" name="drone_flag" value="none">
                            <div class="flag-icon">âœ…</div>
                            <div class="flag-label">í•´ë‹¹ì—†ìŒ</div>
                        </label>
                    </div>
                </div>

                <!-- ê²¬ì  í•„ìš” ì•ˆë‚´ -->
                <div class="quote-needed-box" id="quoteNeededBox">
                    <p id="quoteNeededMsg">ê°œë³„ ê²¬ì ì´ í•„ìš”í•©ë‹ˆë‹¤.<br>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²¬ì /ê°€ì… ì˜ë¢°ë¥¼ ì‹ ì²­í•´ì£¼ì„¸ìš”.</p>
                    <button type="button" class="btn-quote-request" onclick="openQuoteModal()">ğŸ“‹ ê²¬ì /ê°€ì… ì˜ë¢°í•˜ê¸°</button>
                </div>
            </div>


            <!-- í”Œëœ ì„ íƒ ì„¹ì…˜ -->
            <div class="section-card plan-section" id="planSection">
                <h2 class="section-title">í”Œëœ ì„ íƒ</h2>
                <div id="planSectionInner"></div>
                <div class="plan-total-box" id="planTotalBox" style="display:none;">
                    <span class="plan-total-label">ì´ ë³´í—˜ë£Œ (ì—°ê°„)</span>
                    <span class="plan-total-amount" id="planTotalAmount">0ì›</span>
                </div>
            </div>

            <div class="button-group">
                <button type="button" class="btn btn-secondary" onclick="history.back()">ì´ì „</button>
                <button type="submit" class="btn btn-primary" id="submitBtn" disabled>ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
            </div>
        </form>
    </div>

    <!-- ê²¬ì  ì˜ë¢° ëª¨ë‹¬ -->
    <div class="modal-overlay" id="quoteModal">
        <div class="modal-box">
            <div class="modal-head">
                <h2>ğŸ“‹ ê²¬ì  ì˜ë¢°</h2>
                <button class="modal-close-btn" onclick="closeQuoteModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="modal-alert">
                    <p><strong>ê³ ê°ë‹˜ ì£„ì†¡í•©ë‹ˆë‹¤.</strong></p>
                    <p>êµ°ì§‘ë“œë¡  Â· ì„ëŒ€ì‚¬ì—…ìë“œë¡  Â· 100kg ì´ìƒ ë“œë¡ ì€ ì˜¨ë¼ì¸ ê°€ì…ì´ ë¶ˆê°€í•˜ë©°, ë³„ë„ ì‹¬ì‚¬ë¥¼ í†µí•´ ê²¬ì ì„ ì‚°ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.</p>
                    <p>ê°€ì…ì„ í¬ë§í•˜ì‹œëŠ” ê²½ìš° ì•„ë˜ ê²¬ì  ì‹ ì²­ì„ ì‘ì„±í•˜ì—¬ ë³´ë‚´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>
                </div>
                <div class="modal-contact">
                    <strong>ìƒë‹´ë¬¸ì˜</strong>&nbsp;&nbsp;ì´ë©”ì¼: liab.on.ins@gmail.com
                </div>

                <div class="modal-section-title">ì˜¨ë¼ì¸ ê²¬ì ì‹ ì²­</div>
                <form id="quoteForm" onsubmit="submitQuote(event)">
                    <div class="modal-form-group">
                        <label>ê°€ì…ëŒ€ìƒì *</label>
                        <select name="q_customer_type" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="corporation">ë²•ì¸ì‚¬ì—…ì</option>
                            <option value="individual">ê°œì¸ì‚¬ì—…ì</option>
                        </select>
                    </div>
                    <div class="modal-form-group">
                        <label>íšŒì‚¬ëª…</label>
                        <input type="text" name="q_company" placeholder="íšŒì‚¬/ë‹¨ì²´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
                    </div>
                    <div class="modal-form-group">
                        <label>ë“œë¡ ì¤‘ëŸ‰ 25kg ë¯¸ë§Œ</label>
                        <div class="drone-count-row">
                            <input type="number" name="q_under25" min="0" placeholder="ëŒ€ìˆ˜">
                            <span>ëŒ€</span>
                        </div>
                    </div>
                    <div class="modal-form-group">
                        <label>ë“œë¡ ì¤‘ëŸ‰ 25kg ~ 100kg ë¯¸ë§Œ</label>
                        <div class="drone-count-row">
                            <input type="number" name="q_25_100" min="0" placeholder="ëŒ€ìˆ˜">
                            <span>ëŒ€</span>
                        </div>
                    </div>
                    <div class="modal-form-group">
                        <label>ë“œë¡ ì¤‘ëŸ‰ 100kg ì´ìƒ</label>
                        <div class="drone-count-row">
                            <input type="number" name="q_over100" min="0" placeholder="ëŒ€ìˆ˜">
                            <span>ëŒ€</span>
                        </div>
                    </div>
                    <div class="modal-form-row">
                        <div class="modal-form-group">
                            <label>ë‹´ë‹¹ìëª… *</label>
                            <input type="text" name="q_manager" required>
                        </div>
                        <div class="modal-form-group">
                            <label>ë‹´ë‹¹ì ì—°ë½ì²˜ *</label>
                            <input type="tel" name="q_phone" placeholder="010-0000-0000" required>
                        </div>
                    </div>
                    <div class="modal-form-group">
                        <label>ë‹´ë‹¹ì ì´ë©”ì¼ *</label>
                        <input type="email" name="q_email" required>
                    </div>
                    <div class="modal-form-group">
                        <label>ë³´í—˜ìƒí’ˆ</label>
                        <input type="text" value="ë“œë¡ ë°°ìƒì±…ì„ë³´í—˜" readonly style="background:#f8f9fa;">
                    </div>
                    <div class="modal-form-group">
                        <label>ë¬¸ì˜ì‚¬í•­</label>
                        <textarea name="q_inquiry" rows="3" placeholder="ë¬¸ì˜í•˜ì‹¤ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"></textarea>
                    </div>

                    <div class="privacy-scroll">
                        <p><strong>ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ëŒ€í•œ ì•ˆë‚´</strong></p>
                        <p>1. ë°”ì´ì¸ ë° ë°°ìƒì˜¨ì€ "ì •ë³´í†µì‹ ë§ ì´ìš©ì´‰ì§„ ë° ì •ë³´ë³´í˜¸"ì— ê´€í•œ ë²•ë¥ ì„ ì¤€ìˆ˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                        <p>2. ìˆ˜ì§‘íšŒì‚¬ : ë°”ì´ì¸, ë°°ìƒì˜¨</p>
                        <p>3. ìˆ˜ì§‘ëª©ì  : ë³´í—˜ìƒí’ˆ ë¬¸ì˜ì— ë”°ë¥¸ ì•ˆë‚´</p>
                        <p>4. ìˆ˜ì§‘í•­ëª© : íšŒì‚¬ëª…, ì„±ëª…, ì—°ë½ì²˜, ì´ë©”ì¼, ì ‘ì†ip</p>
                        <p>5. ë³´ì¡´ê¸°ê°„ : 5ë…„</p>
                        <p>6. ë³´ì¡´ê·¼ê±° : ì „ììƒê±°ë˜ ë“±ì—ì„œì˜ ì†Œë¹„ìë³´í˜¸ì— ê´€í•œë²•ë¥ /ì‹ ìš©ì •ë³´ì˜ ì´ìš© ë° ë³´í˜¸ì— ê´€í•œ ë²•ë¥ </p>
                        <p>7. ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ëŒ€í•œ ë¯¸ë™ì˜ ì‹œ ì˜¨ë¼ì¸, ì˜¤í”„ë¼ì¸ ë³´í—˜ìƒë‹´ì´ ì œí•œë©ë‹ˆë‹¤.</p>
                    </div>
                    <div class="agree-row">
                        <input type="checkbox" id="quoteAgree" required>
                        <label for="quoteAgree">"ìœ„ì˜ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©"ì— ë™ì˜í•©ë‹ˆë‹¤</label>
                    </div>
                    <button type="submit" class="btn-submit-modal">ê°€ì…ì˜ë¢°í•˜ê¸°</button>
                </form>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <h3 style="margin-bottom:1rem;">ë°°ìƒì˜¨ ëŒ€ë¦¬ì </h3>
            <p>ğŸ“§ ì´ë©”ì¼: liab.on.ins@gmail.com</p>
            <p>ğŸ“ ì£¼ì†Œ: ì„œìš¸íŠ¹ë³„ì‹œ ë™ëŒ€ë¬¸êµ¬ ì²œí˜¸ëŒ€ë¡œ 301, 1706í˜¸</p>
            <p>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 501-63-18916 | í†µì‹ íŒë§¤ì—… ì‹ ê³ ë²ˆí˜¸: ì œ2026-ì„œìš¸ë™ëŒ€ë¬¸-0153í˜¸</p>
            <p>ëŒ€í‘œì: ê¹€ë¦¬í•˜ | ë°°ìƒì˜¨ | ëŒ€ë¦¬ì ë“±ë¡ë²ˆí˜¸: ì œ2026010037í˜¸</p>
            <p style="margin-top:1.5rem;opacity:0.6;">Â© 2026 ë°°ìƒì˜¨ ëŒ€ë¦¬ì . All rights reserved. | KBì†í•´ë³´í—˜ ê³µì‹ ëŒ€ë¦¬ì </p>
        </div>
    </footer>

    <script>
    // â”€â”€ ë“œë¡  ì •ë³´ ë™ì  ìƒì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function makeDroneField(i) {
        const label = i === 0 ? '' : `<div class="drone-info-header"><span class="drone-number">ë“œë¡  ${i+1}</span></div>`;
        return `
        <div class="drone-info-section" id="droneSection_${i}">
            ${i > 0 ? `<div class="drone-info-header"><span class="drone-number">ë“œë¡  ${i+1}</span></div>` : ''}
            <div class="form-row">
                <div class="form-group">
                    <label>ë“œë¡  ëª¨ë¸ëª… ${i===0?'*':''}</label>
                    <input type="text" name="drone_model_${i}" placeholder="ì˜ˆ: DJI Mini 3 Pro" ${i===0?'required':''}>
                </div>
                <div class="form-group">
                    <label>ì œì‘ë²ˆí˜¸(ì‹œë¦¬ì–¼ë²ˆí˜¸) ${i===0?'*':''}</label>
                    <input type="text" name="drone_serial_${i}" placeholder="ì‹œë¦¬ì–¼ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" ${i===0?'required':''}>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ë“œë¡  ì‹ ê³ ë²ˆí˜¸</label>
                    <input type="text" name="drone_reg_${i}" placeholder="ë“œë¡  ì‹ ê³ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label>ë“œë¡  ìì²´ì¤‘ëŸ‰ (kg) ${i===0?'*':''}</label>
                    <input type="number" name="drone_weight_${i}" placeholder="ì˜ˆ: 0.895" step="0.001" min="0" ${i===0?'required':''}>
                </div>
            </div>
            <div class="form-group" style="max-width:50%">
                <label>ë“œë¡  ìµœëŒ€ì´ë¥™ì¤‘ëŸ‰ (kg) ${i===0?'*':''}</label>
                <input type="number" name="drone_mtow_${i}" placeholder="ì˜ˆ: 1.2" step="0.001" min="0" ${i===0?'required':''}>
            </div>
        </div>`;
    }

    function updateDroneFields() {
        const count = parseInt(document.getElementById('droneCount').value) || 1;
        const container = document.getElementById('dronesContainer');
        container.innerHTML = '';
        for (let i = 0; i < count; i++) {
            container.insertAdjacentHTML('beforeend', makeDroneField(i));
        }
        // í”Œëœ ì„¹ì…˜ì´ í‘œì‹œ ì¤‘ì´ë©´ ê°±ì‹ 
        const planSec = document.getElementById('planSection');
        if (planSec && planSec.classList.contains('show')) {
            // ëŒ€ìˆ˜ ì¤„ë©´ ì´ˆê³¼ ì„ íƒ ì œê±°
            Object.keys(selectedPlans).forEach(k => { if (parseInt(k) >= count) delete selectedPlans[k]; });
            renderPlanSection();
            updateSubmitBtn();
        }
    }

    // â”€â”€ ê³ ê° ìœ í˜• ì „í™˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let currentType = 'personal';

    function switchType(type) {
        currentType = type;
        const pFields = document.getElementById('personalFields');
        const cFields = document.getElementById('corporateFields');
        const tabP = document.getElementById('tabPersonal');
        const tabC = document.getElementById('tabCorporate');
        const title = document.getElementById('customerSectionTitle');

        const personalIds = ['personalName','birthDate','personalGender','personalPhone','personalEmail'];
        const corpIds = ['corpNumber','corpName','corpPhone','corpEmail'];

        if (type === 'personal') {
            pFields.style.display = 'block';
            cFields.style.display = 'none';
            tabP.classList.add('active'); tabC.classList.remove('active');
            title.textContent = 'ê³ ê°ì •ë³´ ì…ë ¥';
            personalIds.forEach(id => { const el = document.getElementById(id); if(el) el.setAttribute('required',''); });
            corpIds.forEach(id => { const el = document.getElementById(id); if(el) el.removeAttribute('required'); });
        } else {
            pFields.style.display = 'none';
            cFields.style.display = 'block';
            tabP.classList.remove('active'); tabC.classList.add('active');
            title.textContent = 'ì‚¬ì—…ìì •ë³´ ì…ë ¥';
            corpIds.forEach(id => { const el = document.getElementById(id); if(el) el.setAttribute('required',''); });
            personalIds.forEach(id => { const el = document.getElementById(id); if(el) el.removeAttribute('required'); });
        }
    }

    // â”€â”€ ìƒë…„ì›”ì¼ ìˆ«ìë§Œ ì…ë ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.addEventListener('DOMContentLoaded', function() {
        const bd = document.getElementById('birthDate');
        if (bd) {
            bd.addEventListener('input', function() { this.value = this.value.replace(/[^0-9]/g, ''); });
            bd.addEventListener('keypress', function(e) { if(!/[0-9]/.test(e.key)) e.preventDefault(); });
        }
    });

    // â”€â”€ ë³´í—˜ê¸°ê°„ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function setupInsuranceDates() {
        const startEl = document.getElementById('insuranceStart');
        const endEl   = document.getElementById('insuranceEnd');
        const durEl   = document.getElementById('insuranceDuration');

        function pad(n) { return String(n).padStart(2,'0'); }
        function toLocal(d) {
            return d.getFullYear()+'-'+pad(d.getMonth()+1)+'-'+pad(d.getDate())
                +'T'+pad(d.getHours())+':'+pad(d.getMinutes());
        }
        function round30(d) {
            const ms = 30*60*1000;
            return new Date(Math.ceil(d.getTime()/ms)*ms);
        }
        function addYear(d) {
            const r = new Date(d);
            r.setFullYear(r.getFullYear()+1);
            return r;
        }
        function calcDur() {
            if (!startEl.value || !endEl.value) { durEl.value=''; return; }
            const s = new Date(startEl.value), e = new Date(endEl.value);
            if (e<=s) { durEl.value=''; return; }
            durEl.value = Math.round((e-s)/(1000*60*60*24)) + 'ì¼';
        }

        const minStart = round30(new Date(Date.now() + 30*60*1000));
        startEl.min   = toLocal(minStart);
        startEl.value = toLocal(minStart);
        const initEnd = addYear(minStart);
        endEl.value = toLocal(initEnd);
        endEl.min   = toLocal(minStart);
        endEl.max   = toLocal(initEnd);
        calcDur();

        startEl.addEventListener('change', function() {
            const sel = new Date(this.value);
            const rounded = round30(sel);
            const curMin = round30(new Date(Date.now()+30*60*1000));
            if (rounded < curMin) {
                alert('âš ï¸ ë³´í—˜ ì‹œì‘ì¼ì‹œëŠ” í˜„ì¬ ì‹œê°„ ê¸°ì¤€ 30ë¶„ í›„ë¶€í„° ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                this.value = toLocal(curMin); return;
            }
            this.value = toLocal(rounded);
            const ne = addYear(rounded);
            endEl.value = toLocal(ne); endEl.min = toLocal(rounded); endEl.max = toLocal(ne);
            calcDur();
        });

        endEl.addEventListener('change', function() {
            const s = new Date(startEl.value);
            const rounded = round30(new Date(this.value));
            const maxEnd = addYear(s);
            if (rounded <= s) {
                alert('âš ï¸ ì¢…ë£Œì¼ì‹œëŠ” ì‹œì‘ì¼ì‹œë³´ë‹¤ ì´í›„ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                this.value = toLocal(maxEnd); calcDur(); return;
            }
            if (rounded > maxEnd) {
                alert('âš ï¸ ë³´í—˜ ê¸°ê°„ì€ 1ë…„ì„ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nìµœëŒ€ ì¢…ë£Œì¼ì‹œë¡œ ìë™ ì„¤ì •ë©ë‹ˆë‹¤.');
                this.value = toLocal(maxEnd); calcDur(); return;
            }
            this.value = toLocal(rounded);
            calcDur();
        });
    }

    // â”€â”€ ê°€ì…ë¬¼ê±´ ì„ íƒ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let selectedWeight = '';
    let selectedFlag   = '';

    function selectWeight(el, val) {
        document.querySelectorAll('.weight-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        el.querySelector('input').checked = true;
        selectedWeight = val;
        checkQuoteNeeded();
    }

    function selectFlag(el, val) {
        document.querySelectorAll('.flag-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        el.querySelector('input').checked = true;
        selectedFlag = val;
        checkQuoteNeeded();
    }

    function checkQuoteNeeded() {
        const box       = document.getElementById('quoteNeededBox');
        const msg       = document.getElementById('quoteNeededMsg');
        const submitBtn = document.getElementById('submitBtn');
        const planSec   = document.getElementById('planSection');

        const needQuote = (selectedFlag === 'swarm' || selectedFlag === 'rental' || selectedWeight === 'over_100kg');

        if (needQuote) {
            let reason = '';
            if (selectedFlag === 'swarm')   reason = 'êµ°ì§‘ë“œë¡ ì€';
            else if (selectedFlag === 'rental') reason = 'ì„ëŒ€ì‚¬ì—…ì ë“œë¡ ì€';
            else reason = '100kg ì´ìƒ ë“œë¡ ì€';
            msg.innerHTML = `<strong>${reason} ì˜¨ë¼ì¸ ê°€ì…ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.</strong><br>ë³„ë„ ì‹¬ì‚¬ë¥¼ í†µí•´ ê²¬ì ì„ ì‚°ì¶œí•´ì•¼ í•©ë‹ˆë‹¤.<br>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ê²¬ì /ê°€ì… ì˜ë¢°ë¥¼ ì‹ ì²­í•´ì£¼ì„¸ìš”.`;
            box.classList.add('show');
            planSec.classList.remove('show');
            submitBtn.disabled = true;
        } else {
            box.classList.remove('show');
            if (selectedWeight && selectedFlag) {
                renderPlanSection();
                planSec.classList.add('show');
                // í”Œëœ ì„ íƒ ì™„ë£Œ ì—¬ë¶€ë¡œ ë²„íŠ¼ í™œì„±í™”
                updateSubmitBtn();
            }
        }
    }

    // â”€â”€ ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function openQuoteModal() {
        document.getElementById('quoteModal').classList.add('show');
        document.body.style.overflow = 'hidden';
    }
    function closeQuoteModal() {
        document.getElementById('quoteModal').classList.remove('show');
        document.body.style.overflow = 'auto';
    }
    document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('quoteModal');
        if (modal) modal.addEventListener('click', function(e) {
            if (e.target === modal) closeQuoteModal();
        });
    });

    // â”€â”€ ê²¬ì  í¼ ì œì¶œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function submitQuote(e) {
        e.preventDefault();
        const f = e.target;
        const data = {
            customer_type: f.q_customer_type.value,
            company_name: f.q_company.value,
            drone_under_25kg: f.q_under25.value || 0,
            drone_25_100kg: f.q_25_100.value || 0,
            drone_over_100kg: f.q_over100.value || 0,
            manager_name: f.q_manager.value,
            manager_phone: f.q_phone.value,
            manager_email: f.q_email.value,
            inquiry: f.q_inquiry.value,
            insurance_type: 'ì—…ë¬´ìš© ë“œë¡ ë³´í—˜ (ê²¬ì  ì˜ë¢°)',
            request_type: 'business_quote'
        };
        try {
            const res = await fetch('/api/contact', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            if (res.ok) {
                alert('ê²¬ì  ì˜ë¢°ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.\në‹´ë‹¹ìê°€ í™•ì¸ í›„ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
                closeQuoteModal(); f.reset();
            } else { alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }
        } catch (err) {
            alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì´ë©”ì¼(liab.on.ins@gmail.com)ë¡œ ì§ì ‘ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
        }
    }

    // â”€â”€ í¼ ì œì¶œ (ë‹¤ìŒ ë‹¨ê³„ë¡œ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('droneForm').addEventListener('submit', function(e) {
        e.preventDefault();

        // 100kg ì´ìƒ + í•´ë‹¹ì—†ìŒ â†’ ê²¬ì  íŒì—…
        if (selectedWeight === 'over_100kg' && selectedFlag === 'none') {
            openQuoteModal(); return;
        }
        // êµ°ì§‘/ì„ëŒ€ ì„ íƒ ì‹œ ë§‰ê¸°
        if (selectedFlag === 'swarm' || selectedFlag === 'rental') {
            openQuoteModal(); return;
        }

        const formData = new FormData(this);
        const params = new URLSearchParams();
        for (const [k,v] of formData.entries()) params.append(k,v);
        // í”Œëœ ì„ íƒ ì •ë³´ ì¶”ê°€
        params.set('selected_deductible', selectedDeductible);
        const count = parseInt(document.getElementById('droneCount').value) || 1;
        const prices = PLAN_PRICES[selectedWeight]?.[selectedDeductible] || {};
        for (let i = 0; i < count; i++) {
            const plan = selectedPlans[i] || '';
            params.set('plan_name_' + i, plan);
            params.set('plan_price_' + i, prices[plan] || 0);
            params.set('plan_coverage_personal_' + i, PLAN_COVERAGE[plan]?.personal || '');
            params.set('plan_coverage_property_' + i, PLAN_COVERAGE[plan]?.property || '');
        }
        params.set('plan_total_price', Array.from({length:count}, (_,i) => prices[selectedPlans[i]]||0).reduce((a,b)=>a+b,0));
        sessionStorage.setItem('droneFormData', params.toString());
        window.location.href = '/business-drone-insurance-terms';
    });


    /* ================================================================
       í”Œëœ ì„ íƒ JS
    ================================================================ */
    const PLAN_PRICES = {
        'under_25kg': {
            '10':  { 'ë“ ë“ í˜•': 466000, 'ì•ˆì‹¬í˜•': 440000, 'ì•Œëœ°í˜•': 353000 },
            '100': { 'ë“ ë“ í˜•': 373000, 'ì•ˆì‹¬í˜•': 352000, 'ì•Œëœ°í˜•': 283000 }
        },
        '25_100kg': {
            '10':  { 'ë“ ë“ í˜•': 720000, 'ì•ˆì‹¬í˜•': 679000, 'ì•Œëœ°í˜•': 545000 },
            '100': { 'ë“ ë“ í˜•': 576000, 'ì•ˆì‹¬í˜•': 543000, 'ì•Œëœ°í˜•': 436000 }
        }
    };
    const PLAN_COVERAGE = {
        'ë“ ë“ í˜•': { personal: '5ì–µì›', property: '5ì–µì›' },
        'ì•ˆì‹¬í˜•': { personal: '3ì–µì›', property: '3ì–µì›' },
        'ì•Œëœ°í˜•': { personal: '1ì–µ5ì²œë§Œì›', property: '2ì²œë§Œì›' }
    };
    const PLAN_NAMES = ['ë“ ë“ í˜•', 'ì•ˆì‹¬í˜•', 'ì•Œëœ°í˜•'];

    let selectedDeductible = '10'; // '10' or '100'
    let selectedPlans = {};        // { droneIndex: 'ë“ ë“ í˜•' | 'ì•ˆì‹¬í˜•' | 'ì•Œëœ°í˜•' }

    function setDeductible(val) {
        selectedDeductible = val;
        document.querySelectorAll('.toggle-btn').forEach(b => b.classList.toggle('active', b.dataset.val === val));
        renderPlanSection();
    }

    function renderPlanSection() {
        const inner = document.getElementById('planSectionInner');
        const count = parseInt(document.getElementById('droneCount').value) || 1;

        // ìê¸°ë¶€ë‹´ê¸ˆ í† ê¸€
        let html = `
            <div class="deductible-toggle">
                <span class="deductible-label">ìê¸°ë¶€ë‹´ê¸ˆ ì„ íƒ</span>
                <div class="toggle-btns">
                    <button type="button" class="toggle-btn ${selectedDeductible==='10'?'active':''}" data-val="10" onclick="setDeductible('10')">10ë§Œì›</button>
                    <button type="button" class="toggle-btn ${selectedDeductible==='100'?'active':''}" data-val="100" onclick="setDeductible('100')">100ë§Œì›</button>
                </div>
            </div>`;

        if (count === 1) {
            // ë‹¨ì¼ ë“œë¡ : í”Œëœ í…Œì´ë¸” ë°”ë¡œ í‘œì‹œ
            html += buildPlanTable(0);
        } else {
            // 2ëŒ€ ì´ìƒ: ë“œë¡ ë³„ ì•„ì½”ë””ì–¸
            for (let i = 0; i < count; i++) {
                const chosenPlan = selectedPlans[i] || '';
                const badge = chosenPlan ? `<span class="drone-accordion-badge">${chosenPlan} ì„ íƒë¨</span>` : `<span class="drone-accordion-badge" style="background:#f0f0f0;color:#999;">ë¯¸ì„ íƒ</span>`;
                const isOpen = (i === 0) || chosenPlan;
                html += `
                <div class="drone-plan-accordion" id="accordion_${i}">
                    <div class="drone-accordion-header ${isOpen?'open':''}" onclick="toggleAccordion(${i})">
                        <span class="drone-accordion-title">ë“œë¡  ${i+1}</span>
                        <div style="display:flex;align-items:center;gap:0.8rem;">
                            ${badge}
                            <span class="drone-accordion-arrow">â–¼</span>
                        </div>
                    </div>
                    <div class="drone-accordion-body ${isOpen?'open':''}" id="accordionBody_${i}">
                        ${buildPlanTable(i)}
                    </div>
                </div>`;
            }
        }

        inner.innerHTML = html;
        updateTotalBox();
    }

    function buildPlanTable(droneIdx) {
        const prices = PLAN_PRICES[selectedWeight]?.[selectedDeductible] || {};
        let cols = '';
        PLAN_NAMES.forEach(planName => {
            const price = prices[planName] || 0;
            const cov   = PLAN_COVERAGE[planName];
            const isSel = selectedPlans[droneIdx] === planName;
            cols += `
                <td class="plan-col ${isSel?'selected':''}" onclick="selectPlan(${droneIdx},'${planName}')">
                    <div class="plan-radio-wrap">
                        <input type="radio" name="plan_radio_${droneIdx}" value="${planName}" ${isSel?'checked':''} onchange="selectPlan(${droneIdx},'${planName}')">
                        <span class="plan-name-text">${planName}</span>
                        <span class="plan-price-text">${price.toLocaleString()}ì›</span>
                    </div>
                </td>`;
        });

        return `
            <div class="plan-table-wrap">
                <table class="plan-table">
                    <thead>
                        <tr>
                            <th style="width:30%;text-align:left;">ë³´í—˜ë£Œ</th>
                            ${PLAN_NAMES.map(n => {
                                const price = prices[n] || 0;
                                const isSel = selectedPlans[droneIdx] === n;
                                return `<th class="plan-col-header plan-col ${isSel?'selected':''}" onclick="selectPlan(${droneIdx},'${n}')" style="cursor:pointer;">
                                    <div class="plan-radio-wrap">
                                        <input type="radio" name="plan_radio_${droneIdx}" value="${n}" ${isSel?'checked':''} onchange="selectPlan(${droneIdx},'${n}')">
                                        <span class="plan-name-text">${n}</span>
                                        <span class="plan-price-text">${price.toLocaleString()}ì›</span>
                                    </div>
                                </th>`;
                            }).join('')}
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="row-label">ë³´ì¥ë‚´ìš©</td>
                            ${PLAN_NAMES.map(() => `<td></td>`).join('')}
                        </tr>
                        <tr>
                            <td class="row-label" style="padding-left:1.2rem;">ëŒ€ì¸ ë°°ìƒ</td>
                            ${PLAN_NAMES.map(n => `<td class="plan-col ${selectedPlans[droneIdx]===n?'selected':''}" onclick="selectPlan(${droneIdx},'${n}')">${PLAN_COVERAGE[n].personal}</td>`).join('')}
                        </tr>
                        <tr>
                            <td class="row-label" style="padding-left:1.2rem;">ëŒ€ë¬¼ ë°°ìƒ</td>
                            ${PLAN_NAMES.map(n => `<td class="plan-col ${selectedPlans[droneIdx]===n?'selected':''}" onclick="selectPlan(${droneIdx},'${n}')">${PLAN_COVERAGE[n].property}</td>`).join('')}
                        </tr>
                    </tbody>
                </table>
            </div>`;
    }

    function selectPlan(droneIdx, planName) {
        selectedPlans[droneIdx] = planName;
        renderPlanSection();
        // ì•„ì½”ë””ì–¸ì´ ì—´ë ¤ìˆìœ¼ë©´ ìœ ì§€
        const body = document.getElementById('accordionBody_' + droneIdx);
        const header = body ? body.previousElementSibling : null;
        if (body && !body.classList.contains('open')) {
            body.classList.add('open');
            if (header) header.classList.add('open');
        }
        updateSubmitBtn();
    }

    function toggleAccordion(i) {
        const body   = document.getElementById('accordionBody_' + i);
        const header = document.querySelector('#accordion_' + i + ' .drone-accordion-header');
        if (!body) return;
        const isOpen = body.classList.toggle('open');
        if (header) header.classList.toggle('open', isOpen);
    }

    function updateTotalBox() {
        const count  = parseInt(document.getElementById('droneCount').value) || 1;
        const prices = PLAN_PRICES[selectedWeight]?.[selectedDeductible] || {};
        let total = 0;
        let allSelected = true;
        for (let i = 0; i < count; i++) {
            const plan = selectedPlans[i];
            if (plan && prices[plan]) {
                total += prices[plan];
            } else {
                allSelected = false;
            }
        }
        const box = document.getElementById('planTotalBox');
        const amt = document.getElementById('planTotalAmount');
        if (box && amt) {
            if (total > 0) {
                amt.textContent = total.toLocaleString() + 'ì›';
                box.style.display = 'flex';
            } else {
                box.style.display = 'none';
            }
        }
    }

    function updateSubmitBtn() {
        const count = parseInt(document.getElementById('droneCount').value) || 1;
        let allSelected = true;
        for (let i = 0; i < count; i++) {
            if (!selectedPlans[i]) { allSelected = false; break; }
        }
        const submitBtn = document.getElementById('submitBtn');
        if (!submitBtn) return;
        const needQuote = (selectedFlag === 'swarm' || selectedFlag === 'rental' || selectedWeight === 'over_100kg');
        if (!needQuote && selectedWeight && selectedFlag && allSelected) {
            submitBtn.disabled = false;
        } else if (!needQuote && selectedWeight && selectedFlag && !allSelected) {
            submitBtn.disabled = true;
        }
    }

    // â”€â”€ ì´ˆê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    setupInsuranceDates();
    updateDroneFields();
    </script>
</body>
</html>
